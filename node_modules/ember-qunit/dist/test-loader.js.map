{"version":3,"file":"test-loader.js","sources":["../src/test-loader.js"],"sourcesContent":["import * as QUnit from 'qunit';\nimport AbstractTestLoader, {\n  addModuleExcludeMatcher,\n  addModuleIncludeMatcher,\n} from 'ember-cli-test-loader/test-support/index';\n\naddModuleExcludeMatcher(function (moduleName) {\n  return QUnit.urlParams.nolint && moduleName.match(/\\.(jshint|lint-test)$/);\n});\n\naddModuleIncludeMatcher(function (moduleName) {\n  return moduleName.match(/\\.jshint$/);\n});\n\nlet moduleLoadFailures = [];\n\nQUnit.done(function () {\n  let length = moduleLoadFailures.length;\n\n  try {\n    if (length === 0) {\n      // do nothing\n    } else if (length === 1) {\n      throw moduleLoadFailures[0];\n    } else {\n      throw new Error('\\n' + moduleLoadFailures.join('\\n'));\n    }\n  } finally {\n    // ensure we release previously captured errors.\n    moduleLoadFailures = [];\n  }\n});\n\nexport class TestLoader extends AbstractTestLoader {\n  moduleLoadFailure(moduleName, error) {\n    moduleLoadFailures.push(error);\n\n    QUnit.module('TestLoader Failures');\n    QUnit.test(moduleName + ': could not be loaded', function () {\n      throw error;\n    });\n  }\n}\n\n/**\n   Load tests following the default patterns:\n\n   * The module name ends with `-test`\n   * The module name ends with `.jshint`\n\n   Excludes tests that match the following\n   patterns when `?nolint` URL param is set:\n\n   * The module name ends with `.jshint`\n   * The module name ends with `-lint-test`\n\n   @method loadTests\n */\nexport function loadTests() {\n  new TestLoader().loadModules();\n}\n"],"names":["addModuleExcludeMatcher","moduleName","QUnit","urlParams","nolint","match","addModuleIncludeMatcher","moduleLoadFailures","done","length","Error","join","TestLoader","AbstractTestLoader","moduleLoadFailure","error","push","module","test","loadTests","loadModules"],"mappings":";;;AAMAA,uBAAuB,CAAC,UAAUC,UAAU,EAAE;EAC5C,OAAOC,KAAK,CAACC,SAAS,CAACC,MAAM,IAAIH,UAAU,CAACI,KAAK,CAAC,uBAAuB,CAAC;AAC5E,CAAC,CAAC;AAEFC,uBAAuB,CAAC,UAAUL,UAAU,EAAE;EAC5C,OAAOA,UAAU,CAACI,KAAK,CAAC,WAAW,CAAC;AACtC,CAAC,CAAC;AAEF,IAAIE,kBAAkB,GAAG,EAAE;AAE3BL,KAAK,CAACM,IAAI,CAAC,YAAY;EACrB,IAAIC,MAAM,GAAGF,kBAAkB,CAACE,MAAM;EAEtC,IAAI;IACF,IAAIA,MAAM,KAAK,CAAC,EAAE;;KAEjB,MAAM,IAAIA,MAAM,KAAK,CAAC,EAAE;MACvB,MAAMF,kBAAkB,CAAC,CAAC,CAAC;KAC5B,MAAM;MACL,MAAM,IAAIG,KAAK,CAAC,IAAI,GAAGH,kBAAkB,CAACI,IAAI,CAAC,IAAI,CAAC,CAAC;;GAExD,SAAS;;IAERJ,kBAAkB,GAAG,EAAE;;AAE3B,CAAC,CAAC;AAEK,MAAMK,UAAU,SAASC,kBAAkB,CAAC;EACjDC,iBAAiBA,CAACb,UAAU,EAAEc,KAAK,EAAE;IACnCR,kBAAkB,CAACS,IAAI,CAACD,KAAK,CAAC;IAE9Bb,KAAK,CAACe,MAAM,CAAC,qBAAqB,CAAC;IACnCf,KAAK,CAACgB,IAAI,CAACjB,UAAU,GAAG,uBAAuB,EAAE,YAAY;MAC3D,MAAMc,KAAK;KACZ,CAAC;;AAEN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASI,SAASA,GAAG;EAC1B,IAAIP,UAAU,EAAE,CAACQ,WAAW,EAAE;AAChC;;;;"}